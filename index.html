<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Renette: Project Apple | –Ø–±–ª–æ—á–Ω—ã–π –ü—Ä–µ—Å–µ—Ç</title>
    <meta name="description" content="–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ö–∞–± –ø—Ä–µ—Å–µ—Ç–∞ '–Ø–±–ª–æ—á–Ω—ã–π'. –¶–∏—Ñ—Ä–æ–≤–æ–π –¥—É—Ö –†–µ–Ω–µ—Ç—Ç.">
    <meta name="google-site-verification" content="L1aS8txxzlMjDV_Efl0Oi1WDR0J7_DCdyazGjG1zVPk" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            /* Palette */
            --bg-deep: #161618;
            --bg-panel: #1e1e24;
            --bg-lighter: #2a2a32;

            --mint: #6fffe9;
            --mint-dim: #41b3a3;
            --apple-red: #ff5e5e;
            --lilac: #d4b3ff;
            --lilac-glow: rgba(212, 179, 255, 0.3);

            --text-main: #f0f0f5;
            --text-muted: #8b8b99;

            --border-radius: 20px;
            --glass: rgba(30, 30, 36, 0.7);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; scroll-behavior: smooth; }

        body {
            background-color: var(--bg-deep);
            color: var(--text-main);
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
        }

        /* --- INTERACTIVE BACKGROUND --- */
        .orb-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }

        .orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            opacity: 0.4;
            animation: float 20s infinite ease-in-out;
        }

        .orb-1 { width: 400px; height: 400px; background: var(--apple-red); top: -100px; left: -100px; animation-duration: 25s; }
        .orb-2 { width: 500px; height: 500px; background: var(--mint-dim); bottom: -150px; right: -100px; animation-duration: 30s; animation-delay: -5s; }
        .orb-3 { width: 300px; height: 300px; background: var(--lilac); top: 40%; left: 30%; animation-duration: 35s; opacity: 0.2; }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }

        /* --- DECORATIVE ELEMENTS --- */
        .decor-line {
            position: fixed;
            width: 1px;
            height: 100vh;
            background: linear-gradient(to bottom, transparent, var(--mint), transparent);
            opacity: 0.1;
            left: 10%;
            z-index: -1;
        }

        /* --- HEADER REDESIGN --- */
        header {
            position: relative;
            min-height: 90vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 5%;
            overflow: hidden;
        }

        .header-content {
            display: grid;
            grid-template-columns: 1.2fr 1fr;
            gap: 50px;
            max-width: 1400px;
            width: 100%;
            align-items: center;
            z-index: 2;
        }

        .header-text h1 {
            font-size: clamp(3rem, 6vw, 5.5rem);
            line-height: 0.9;
            font-weight: 800;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: -2px;
            position: relative;
        }

        .header-text h1 span { color: var(--apple-red); }

        .badge {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(111, 255, 233, 0.1);
            border: 1px solid var(--mint);
            color: var(--mint);
            border-radius: 50px;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem;
            margin-bottom: 20px;
            backdrop-filter: blur(5px);
        }

        .header-desc {
            font-size: 1.1rem;
            color: var(--text-muted);
            max-width: 500px;
            line-height: 1.6;
            margin-bottom: 40px;
            border-left: 3px solid var(--lilac);
            padding-left: 20px;
        }

        /* 3D CARD VISUAL */
        .visual-container {
            position: relative;
            height: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .renette-card {
            width: 320px;
            height: 480px;
            background: linear-gradient(145deg, rgba(255,255,255,0.05), rgba(0,0,0,0.2));
            border: 1px solid var(--glass);
            border-radius: 30px;
            position: relative;
            backdrop-filter: blur(20px);
            box-shadow: 20px 20px 60px rgba(0,0,0,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            transition: transform 0.5s ease;
            transform-style: preserve-3d;
        }

        .renette-card:hover { transform: rotateY(10deg) rotateX(5deg); }

        .card-img {
            width: 100%;
            height: 60%;
            border-radius: 20px;
            background: #000;
            object-fit: cover;
            margin-bottom: 20px;
            border: 2px solid var(--mint-dim);
        }

        /* --- BUTTONS --- */
        .btn-group { display: flex; gap: 20px; flex-wrap: wrap; }

        .btn {
            padding: 15px 35px;
            border-radius: 12px;
            font-weight: 700;
            text-decoration: none;
            transition: 0.3s;
            position: relative;
            overflow: hidden;
            font-family: 'Montserrat', sans-serif;
            cursor: pointer;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: var(--mint);
            color: #1a1a1a;
            box-shadow: 0 0 20px rgba(111, 255, 233, 0.4);
        }

        .btn-primary:hover { background: #fff; transform: translateY(-3px); }

        .btn-secondary {
            background: transparent;
            border: 1px solid var(--text-muted);
            color: var(--text-main);
        }

        .btn-secondary:hover { border-color: var(--apple-red); color: var(--apple-red); }

        /* --- COMPLEX PROMPT BUILDER --- */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 50px 20px;
            position: relative;
            z-index: 2;
        }

        .section-title {
            font-size: 2.5rem;
            margin-bottom: 40px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .section-title i { color: var(--apple-red); }

        /* BLOCKS ACCORDION */
        .block-wrapper {
            margin-bottom: 30px;
            background: var(--bg-panel);
            border-radius: var(--border-radius);
            border: 1px solid rgba(255,255,255,0.05);
            overflow: hidden;
        }

        .block-header {
            padding: 25px 30px;
            background: linear-gradient(90deg, rgba(255,255,255,0.03), transparent);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: 0.3s;
        }

        .block-header:hover { background: rgba(255,255,255,0.06); }
        .block-header h3 { font-size: 1.4rem; font-weight: 600; display: flex; gap: 15px; align-items: center; }
        .block-num { color: var(--text-muted); font-family: 'JetBrains Mono', monospace; font-size: 0.9rem; }

        .block-content {
            padding: 0 30px 30px 30px;
            display: none; /* JS toggle */
        }

        .block-content.active { display: block; animation: slideDown 0.4s ease; }

        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* SUB-GROUPS */
        .sub-group {
            margin-top: 25px;
            padding-left: 15px;
            border-left: 2px solid var(--bg-lighter);
        }

        .sub-group-title {
            color: var(--lilac);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        /* OPTION CARD */
        .option-card {
            background: var(--bg-lighter);
            padding: 15px 20px;
            border-radius: 12px;
            cursor: pointer;
            border: 1px solid transparent;
            transition: 0.2s;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .option-card:hover { border-color: var(--text-muted); }

        .option-card.selected {
            background: rgba(111, 255, 233, 0.1);
            border-color: var(--mint);
        }

        .option-card.conflict { opacity: 0.5; pointer-events: none; } /* Visual logic if needed */

        .option-name { font-weight: 600; font-size: 0.95rem; }
        .option-type { font-size: 0.7rem; color: var(--text-muted); text-transform: uppercase; margin-top: 4px; }

        .check-circle {
            width: 20px; height: 20px;
            border-radius: 50%;
            border: 2px solid var(--text-muted);
            flex-shrink: 0;
            display: flex; align-items: center; justify-content: center;
        }

        .option-card.selected .check-circle {
            background: var(--mint);
            border-color: var(--mint);
            color: #000;
        }

        /* --- GUIDES (CAROUSEL STYLE) --- */
        .guides-container {
            display: flex;
            overflow-x: auto;
            gap: 25px;
            padding: 20px 0;
            scrollbar-width: none;
        }

        .guide-card {
            min-width: 300px;
            background: linear-gradient(160deg, var(--bg-panel), var(--bg-lighter));
            border-radius: 20px;
            padding: 30px;
            position: relative;
            border-top: 3px solid var(--mint-dim);
            flex-shrink: 0;
            transition: 0.3s;
        }

        .guide-card:nth-child(even) { border-color: var(--apple-red); }

        .guide-card:hover { transform: translateY(-10px); }

        .guide-icon {
            font-size: 2rem;
            margin-bottom: 20px;
            color: var(--text-main);
        }

        /* --- FOOTER / CLIPBOARD --- */
        .clipboard-bar {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(150%);
            background: rgba(22, 22, 24, 0.9);
            backdrop-filter: blur(20px);
            padding: 15px 30px;
            border-radius: 50px;
            border: 1px solid var(--mint);
            display: flex;
            align-items: center;
            gap: 20px;
            z-index: 100;
            transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .clipboard-bar.active { transform: translateX(-50%) translateY(0); }

        .clip-info { font-family: 'JetBrains Mono'; font-size: 0.9rem; color: var(--mint); }

        /* --- MODAL --- */
        .modal-wrap {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0; pointer-events: none;
            transition: 0.3s;
        }

        .modal-wrap.active { opacity: 1; pointer-events: all; }

        .modal-box {
            background: var(--bg-panel);
            width: 90%; max-width: 800px;
            max-height: 85vh;
            border-radius: 20px;
            border: 1px solid var(--lilac-glow);
            padding: 0;
            overflow: hidden;
            display: flex; flex-direction: column;
        }

        .modal-img-area {
            height: 300px;
            background: #000;
            position: relative;
        }

        .modal-img-area img { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; }

        .modal-text-area { padding: 30px; overflow-y: auto; }

        /* --- MOBILE --- */
        @media (max-width: 900px) {
            .header-content { grid-template-columns: 1fr; text-align: center; }
            .header-text h1 { font-size: 3.5rem; }
            .header-desc { margin: 0 auto 30px auto; border: none; }
            .visual-container { display: none; } /* Hide 3D card on mobile */
            .clipboard-bar { width: 90%; justify-content: space-between; border-radius: 15px; }
        }
    </style>
</head>
<body>

    <!-- Background Elements -->
    <div class="orb-container">
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
    </div>
    <div class="decor-line"></div>

    <!-- HEADER -->
    <header>
        <div class="header-content">
            <div class="header-text">
                <span class="badge"><i class="fa-solid fa-code-branch"></i> v2.0 SYSTEM READY</span>
                <h1>Project<br><span>Apple</span></h1>
                <p class="header-desc">
                    –ì–ª–æ–±–∞–ª—å–Ω–∞—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è SillyTavern. –¶–∏—Ñ—Ä–æ–≤–æ–π –¥—É—Ö <b>–†–µ–Ω–µ—Ç—Ç</b>, –∂–∏–≤—É—â–∞—è –Ω–∞ —Å—Ç—ã–∫–µ –ø—Ä–∏—Ä–æ–¥—ã –∏ –∫–æ–¥–∞.
                    <br><br>
                    –£–º–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø–æ–ª–Ω–∞—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è –∏ —ç—Å—Ç–µ—Ç–∏–∫–∞ –º—è—Ç–Ω–æ–≥–æ –Ω–µ–æ–Ω–∞.
                </p>
                <div class="btn-group">
                    <a href="#prompt-builder" class="btn btn-primary">
                        <i class="fa-solid fa-layer-group"></i> –°–æ–±—Ä–∞—Ç—å –ü—Ä–µ—Å–µ—Ç
                    </a>
                    <a href="https://github.com/YOUR_REPO" target="_blank" class="btn btn-secondary">
                        <i class="fa-brands fa-github"></i> –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
                    </a>
                </div>
            </div>

            <div class="visual-container">
                <div class="renette-card">
                    <!-- –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ—é –∫–∞—Ä—Ç–∏–Ω–∫—É -->
                    <img src="https://files.catbox.moe/placeholder_renette.png" class="card-img" alt="Renette">
                    <h3 style="margin-bottom: 5px;">RENETTE</h3>
                    <p style="font-size: 0.8rem; color: var(--mint);">[Digital Spirit]</p>
                    <div style="margin-top: auto; width: 100%; display: flex; justify-content: space-between; font-family: 'JetBrains Mono'; font-size: 0.7rem; color: #555;">
                        <span>ID: 8080</span>
                        <span>STATUS: ONLINE</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- MAIN CONTENT -->
    <div class="main-container" id="prompt-builder">

        <h2 class="section-title"><i class="fa-solid fa-cubes"></i> –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –Ø–¥—Ä–∞</h2>
        <p style="margin-bottom: 40px; color: var(--text-muted);">–†–∞—Å–∫—Ä–æ–π—Ç–µ –±–ª–æ–∫–∏, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.</p>

        <!-- CONTAINER FOR JS GENERATED BLOCKS -->
        <div id="blocks-container"></div>

        <!-- GUIDES SECTION -->
        <div style="margin-top: 100px;">
            <h2 class="section-title"><i class="fa-solid fa-book-open"></i> –ë–∞–∑–∞ –ó–Ω–∞–Ω–∏–π</h2>
            <div class="guides-container">
                <div class="guide-card">
                    <div class="guide-icon"><i class="fa-solid fa-download"></i></div>
                    <h3>–£—Å—Ç–∞–Ω–æ–≤–∫–∞</h3>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #aaa;">–°–∫–∞—á–∞–π—Ç–µ JSON —Ñ–∞–π–ª. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ –º–µ–Ω—é "Extensions" –∏–ª–∏ "Presets". –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Context Template —á–∏—Å—Ç.</p>
                </div>
                <div class="guide-card">
                    <div class="guide-icon"><i class="fa-solid fa-palette"></i></div>
                    <h3>HTML & CSS</h3>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #aaa;">–í–∫–ª—é—á–∏—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ HTML –≤ —á–∞—Ç–µ. –†–µ–Ω–µ—Ç—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –ø—É–∑—ã—Ä–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π.</p>
                </div>
                <div class="guide-card">
                    <div class="guide-icon"><i class="fa-solid fa-wand-magic-sparkles"></i></div>
                    <h3>–ü—Ä–æ–º–ø—Ç–∏–Ω–≥</h3>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #aaa;">–ö–∞–∫ –ø–∏—Å–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–¥ —ç—Ç–æ—Ç –ø—Ä–µ—Å–µ—Ç? –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ [placeholder] –≥–∞–π–¥—ã –¥–ª—è –ª—É—á—à–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.</p>
                </div>
            </div>
        </div>

    </div>

    <!-- CLIPBOARD BAR -->
    <div class="clipboard-bar" id="clipBar">
        <span class="clip-info">–í–´–ë–†–ê–ù–û: <b id="count">0</b></span>
        <button class="btn btn-primary" style="padding: 10px 25px; font-size: 0.9rem;" onclick="copyAll()">
            <i class="fa-regular fa-copy"></i> –ö–û–ü–ò–†–û–í–ê–¢–¨
        </button>
        <button class="btn btn-secondary" style="border: none; color: #666;" onclick="clearAll()">
            <i class="fa-solid fa-rotate-left"></i>
        </button>
    </div>

    <!-- LIGHTBOX MODAL -->
    <div class="modal-wrap" id="modal" onclick="closeModal(event)">
        <div class="modal-box">
            <div class="modal-img-area">
                <img id="modal-img" src="" alt="">
                <button onclick="closeModal(null, true)" style="position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.5); border: none; color: white; width: 40px; height: 40px; border-radius: 50%; cursor: pointer;">‚úï</button>
            </div>
            <div class="modal-text-area">
                <h3 id="modal-title" style="color: var(--mint); margin-bottom: 15px;">Title</h3>
                <p id="modal-desc" style="color: #ddd; line-height: 1.6;">Desc</p>
                <div style="margin-top: 20px; padding: 15px; background: #111; border-radius: 10px; font-family: 'JetBrains Mono'; font-size: 0.8rem; color: #666;">
                    Preview content hidden. Copy to see full prompt.
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- DATA STRUCTURE (The Brain) ---
        // type: 'static' (non-selectable, always included if block active? No, let's assume all here are copyable)
        // logic: 'radio' (select 1) or 'checkbox' (select multiple)

        const presetData = [
            {
                id: "block1",
                name: "1. OOC (–í–Ω–µ –∏–≥—Ä—ã)",
                desc: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–∏—á–Ω–æ—Å—Ç–∏ –†–µ–Ω–µ—Ç—Ç –¥–ª—è –æ–±—â–µ–Ω–∏—è –≤–Ω–µ —Ä–æ–ª–µ–≤–æ–π.",
                groups: [
                    {
                        name: "–ë–∞–∑–æ–≤—ã–π –º–æ–¥—É–ª—å",
                        type: "static", // Only one option, always visible
                        items: [
                            { id: "ooc_main", name: "Renette OOC Core", desc: "–ö–∞–æ–º–æ–¥–∂–∏ –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ç–æ–Ω.", content: "[placeholder] OOC Text", img: "" }
                        ]
                    }
                ]
            },
            {
                id: "block2",
                name: "2. –û—Å–Ω–æ–≤–Ω–æ–µ (Core)",
                desc: "–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞, —Å—Ç–∏–ª—å, —è–∑—ã–∫ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è.",
                groups: [
                    {
                        name: "üåæ –†–µ–∂–∏–º –ü–∏—Å—å–º–∞",
                        type: "radio", // Select 1 of 3
                        items: [
                            { id: "write_v1", name: "–í–∞—Ä–∏–∞–Ω—Ç 1 (–°—Ç–∞–Ω–¥–∞—Ä—Ç)", desc: "–ë–∞–ª–∞–Ω—Å –¥–∏–∞–ª–æ–≥–æ–≤ –∏ –¥–µ–π—Å—Ç–≤–∏–π.", content: "[placeholder] Write 1", img: "" },
                            { id: "write_v2", name: "–í–∞—Ä–∏–∞–Ω—Ç 2 (–ù–æ–≤–µ–ª–ª–∞)", desc: "–ë–æ–ª—å—à–µ –æ–ø–∏—Å–∞–Ω–∏–π.", content: "[placeholder] Write 2", img: "" },
                            { id: "write_v3", name: "–í–∞—Ä–∏–∞–Ω—Ç 3 (–ß–∞—Ç)", desc: "–ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã.", content: "[placeholder] Write 3", img: "" }
                        ]
                    },
                    {
                        name: "‚ùå –ë–∞–Ω—ã (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)",
                        type: "radio",
                        items: [
                            { id: "ban_v1", name: "–°—Ç—Ä–æ–≥–∏–µ –ë–∞–Ω—ã", desc: "–ó–∞–ø—Ä–µ—Ç –Ω–∞ –∫–ª–∏—à–µ.", content: "[placeholder] Ban 1", img: "" },
                            { id: "ban_v2", name: "–ú—è–≥–∫–∏–µ –ë–∞–Ω—ã", desc: "–ú–µ–Ω—å—à–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.", content: "[placeholder] Ban 2", img: "" },
                            { id: "ban_v3", name: "–ë–µ–∑ –ë–∞–Ω–æ–≤", desc: "–°–≤–æ–±–æ–¥–Ω—ã–π —Å—Ç–∏–ª—å.", content: "[placeholder] Ban 3", img: "" }
                        ]
                    },
                    {
                        name: "üåê –Ø–∑—ã–∫",
                        type: "radio",
                        items: [
                            { id: "lang_ru", name: "–†—É—Å—Å–∫–∏–π", desc: "–¢–æ–ª—å–∫–æ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫.", content: "[placeholder] RU", img: "" },
                            { id: "lang_en", name: "English", desc: "English output.", content: "[placeholder] EN", img: "" },
                            { id: "lang_mix", name: "Mixed", desc: "–°–º–µ—à–∞–Ω–Ω—ã–π.", content: "[placeholder] Mix", img: "" }
                        ]
                    },
                    {
                        name: "üìì –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –°—Ç–∏–ª—å",
                        type: "radio",
                        items: [
                            { id: "style_1", name: "Liu Zhenyun", desc: "–°—É—Ö–æ–π —é–º–æ—Ä, –∞–±—Å—É—Ä–¥.", content: "[placeholder] Style 1", img: "" },
                            { id: "style_2", name: "Dark Fantasy", desc: "–ú—Ä–∞—á–Ω—ã–π —Ç–æ–Ω.", content: "[placeholder] Style 2", img: "" },
                            { id: "style_3", name: "Romance", desc: "–§–æ–∫—É—Å –Ω–∞ —á—É–≤—Å—Ç–≤–∞—Ö.", content: "[placeholder] Style 3", img: "" },
                            { id: "style_4", name: "Cyberpunk", desc: "–¢–µ—Ö–Ω–æ-—Å–ª–µ–Ω–≥.", content: "[placeholder] Style 4", img: "" },
                            { id: "style_5", name: "Poetic", desc: "–ú–µ—Ç–∞—Ñ–æ—Ä—ã.", content: "[placeholder] Style 5", img: "" },
                            { id: "style_6", name: "Direct", desc: "–ü—Ä—è–º–æ–π —Ç–µ–∫—Å—Ç.", content: "[placeholder] Style 6", img: "" }
                        ]
                    },
                    {
                        name: "üå± –¢–µ–º–ø –û—Ç–Ω–æ—à–µ–Ω–∏–π",
                        type: "radio",
                        items: [
                            { id: "pace_slow", name: "Slow Burn", desc: "–ú–µ–¥–ª–µ–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ.", content: "[placeholder] Slow", img: "" },
                            { id: "pace_fast", name: "Fast Paced", desc: "–ë—ã—Å—Ç—Ä–æ–µ —Å–±–ª–∏–∂–µ–Ω–∏–µ.", content: "[placeholder] Fast", img: "" }
                        ]
                    },
                    {
                        name: "üìè –î–ª–∏–Ω–∞ –û—Ç–≤–µ—Ç–∞",
                        type: "radio",
                        items: [
                            { id: "len_1", name: "Short", desc: "1-2 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞.", content: "[placeholder] Len 1", img: "" },
                            { id: "len_2", name: "Medium", desc: "3-4 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–∞.", content: "[placeholder] Len 2", img: "" },
                            { id: "len_3", name: "Long", desc: "6 –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤ (–°—Ç–∞–Ω–¥–∞—Ä—Ç).", content: "[placeholder] Len 3", img: "" },
                            { id: "len_4", name: "Novel", desc: "8+ –ø–∞—Ä–∞–≥—Ä–∞—Ñ–æ–≤.", content: "[placeholder] Len 4", img: "" },
                            { id: "len_5", name: "Adaptive", desc: "–ü–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —é–∑–µ—Ä–∞.", content: "[placeholder] Len 5", img: "" }
                        ]
                    }
                ]
            },
            {
                id: "block3",
                name: "3. –†–µ–π—Ç–∏–Ω–≥",
                desc: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ 18+.",
                groups: [
                    {
                        name: "NSFW –ú–æ–¥—É–ª—å",
                        type: "static",
                        items: [
                            { id: "nsfw_core", name: "NSFW Instructions", desc: "–ü–æ–ª–Ω–∞—è –∞–Ω–∞—Ç–æ–º–∏—è –∏ –ª–µ–∫—Å–∏–∫–∞.", content: "[placeholder] NSFW", img: "" }
                        ]
                    }
                ]
            },
            {
                id: "block4",
                name: "4. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ (Extras)",
                desc: "HTML, –í–∏–∑—É–∞–ª, –ú–µ—Ö–∞–Ω–∏–∫–∏ –∏ –®—Ç—É–∫–∏.",
                groups: [
                    {
                        name: "üßÉ HTML Base",
                        type: "radio",
                        items: [
                            { id: "html_v1", name: "Full Visuals", desc: "–ü–æ–ª–Ω—ã–π CSS –ø–∞–∫–µ—Ç.", content: "[placeholder] HTML 1", img: "" },
                            { id: "html_v2", name: "Lite Version", desc: "–û–±–ª–µ–≥—á–µ–Ω–Ω—ã–π –∫–æ–¥.", content: "[placeholder] HTML 2", img: "" }
                        ]
                    },
                    {
                        name: "üåó –¢–µ–º–∞ HTML",
                        type: "radio",
                        items: [
                            { id: "theme_dark", name: "Dark Theme", desc: "–¢–µ–º–Ω–∞—è —Ç–µ–º–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è).", content: "[placeholder] Dark", img: "" },
                            { id: "theme_light", name: "Light Theme", desc: "–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞.", content: "[placeholder] Light", img: "" }
                        ]
                    },
                    // --- THE BIG TEMPLATE SECTION ---
                    {
                        name: "‚úéüß∫ –®—Ç—É–∫–∏ (–ë–∞–∑–æ–≤—ã–µ)",
                        type: "checkbox", // Multi-select
                        items: [
                            { id: "stuff_1", name: "–®—Ç—É–∫–∞ 1", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_2", name: "–®—Ç—É–∫–∞ 2", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_3", name: "–®—Ç—É–∫–∞ 3", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_4", name: "–®—Ç—É–∫–∞ 4", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_5", name: "–®—Ç—É–∫–∞ 5", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_6", name: "–®—Ç—É–∫–∞ 6", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_7", name: "–®—Ç—É–∫–∞ 7", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" },
                            { id: "stuff_8", name: "–®—Ç—É–∫–∞ 8", desc: "–û–ø–∏—Å–∞–Ω–∏–µ...", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ –ò–Ω—Ñ–æ–±–ª–æ–∫–∏ (–í—ã–±—Ä–∞—Ç—å 1)",
                        type: "radio",
                        items: [
                            { id: "info_1", name: "Info V1", desc: "–°—Ç–∏–ª—å 1", content: "[placeholder]", img: "" },
                            { id: "info_2", name: "Info V2", desc: "–°—Ç–∏–ª—å 2", content: "[placeholder]", img: "" },
                            { id: "info_3", name: "Info V3", desc: "–°—Ç–∏–ª—å 3", content: "[placeholder]", img: "" },
                            { id: "info_4", name: "Info V4", desc: "–°—Ç–∏–ª—å 4", content: "[placeholder]", img: "" },
                            { id: "info_5", name: "Info V5", desc: "–°—Ç–∏–ª—å 5", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ –†–µ–∂–∏–º –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–í—ã–±—Ä–∞—Ç—å 1)",
                        type: "radio",
                        items: [
                            { id: "set_1", name: "Mode A", desc: "...", content: "[placeholder]", img: "" },
                            { id: "set_2", name: "Mode B", desc: "...", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ CYOA (–í—ã–±—Ä–∞—Ç—å 1)",
                        type: "radio",
                        items: [
                            { id: "cyoa_1", name: "CYOA Classic", desc: "...", content: "[placeholder]", img: "" },
                            { id: "cyoa_2", name: "CYOA Modern", desc: "...", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ –°–∫—Ä—ã—Ç—ã–µ –ë–ª–æ–∫–∏ (–ú—É–ª—å—Ç–∏)",
                        type: "checkbox",
                        items: [
                            { id: "hid_1", name: "Hidden 1", desc: "...", content: "[placeholder]", img: "" },
                            { id: "hid_2", name: "Hidden 2", desc: "...", content: "[placeholder]", img: "" },
                            { id: "hid_3", name: "Hidden 3", desc: "...", content: "[placeholder]", img: "" },
                            { id: "hid_4", name: "Hidden 4", desc: "...", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ Fancy UI (–í—ã–±—Ä–∞—Ç—å 1)",
                        type: "radio",
                        items: [
                            { id: "ui_1", name: "UI Minimal", desc: "...", content: "[placeholder]", img: "" },
                            { id: "ui_2", name: "UI Glass", desc: "...", content: "[placeholder]", img: "" },
                            { id: "ui_3", name: "UI Cyber", desc: "...", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ –ö–æ–º–º–µ–Ω—Ç—ã (–í—ã–±—Ä–∞—Ç—å 1)",
                        type: "radio",
                        items: [
                            { id: "com_1", name: "Comments V1", desc: "...", content: "[placeholder]", img: "" },
                            { id: "com_2", name: "Comments V2", desc: "...", content: "[placeholder]", img: "" },
                            { id: "com_3", name: "Comments V3", desc: "...", content: "[placeholder]", img: "" }
                        ]
                    },
                    {
                        name: "‚úéüß∫ –•—Ä–æ–Ω–∏–∫–∏ (–í—ã–±—Ä–∞—Ç—å 1)",
                        type: "radio",
                        items: [
                            { id: "chron_1", name: "Chronicles Light", desc: "...", content: "[placeholder]", img: "" },
                            { id: "chron_2", name: "Chronicles Full", desc: "...", content: "[placeholder]", img: "" }
                        ]
                    }
                ]
            },
            {
                id: "block5",
                name: "5. –î—É–º–∞–ª–∫–∞ (Thinking)",
                desc: "–õ–æ–≥–∏–∫–∞ CoT (Chain of Thought).",
                groups: [
                    {
                        name: "–ë–∞–∑–æ–≤–∞—è –î—É–º–∞–ª–∫–∞",
                        type: "static",
                        items: [{ id: "think_main", name: "Smart Thinking", desc: "–®–∞–±–ª–æ–Ω –º—ã—Å–ª–µ–π.", content: "[placeholder]", img: "" }]
                    }
                ]
            },
            {
                id: "block6",
                name: "6. –ü—Ä–µ—Ñ–∏–ª (Prefill)",
                desc: "–ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞.",
                groups: [
                    {
                        name: "–ë–∞–∑–æ–≤—ã–π –ü—Ä–µ—Ñ–∏–ª",
                        type: "static",
                        items: [{ id: "prefill_main", name: "Start Prefill", desc: "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è.", content: "[placeholder]", img: "" }]
                    }
                ]
            }
        ];

        // --- STATE MANAGER ---
        let selectedItems = new Set();

        // --- RENDER LOGIC ---
        const container = document.getElementById('blocks-container');

        function init() {
            presetData.forEach(block => {
                // Create Block HTML
                const blockDiv = document.createElement('div');
                blockDiv.className = 'block-wrapper';

                let groupsHTML = '';
                block.groups.forEach((group, gIndex) => {
                    let itemsHTML = '';
                    group.items.forEach(item => {
                        itemsHTML += `
                            <div class="option-card" id="card-${item.id}" onclick="handleSelect('${block.id}', '${gIndex}', '${item.id}', '${group.type}')">
                                <div>
                                    <div class="option-name">${item.name}</div>
                                    <div class="option-type">${group.type === 'radio' ? '–û–¥–∏–Ω –∏–∑' : (group.type === 'static' ? 'Basic' : '–ú—É–ª—å—Ç–∏')}</div>
                                </div>
                                <div class="check-circle" id="check-${item.id}">
                                    ${group.type === 'radio' ? '' : '<i class="fa-solid fa-check" style="font-size: 0.7rem; opacity: 0;"></i>'}
                                </div>
                                <button onclick="openLightbox('${item.id}', event)" style="position:absolute; top: 10px; right: 10px; border:none; background: transparent; color: #666; cursor: pointer;">
                                    <i class="fa-solid fa-circle-info"></i>
                                </button>
                            </div>
                        `;
                    });

                    groupsHTML += `
                        <div class="sub-group">
                            <div class="sub-group-title">${group.name}</div>
                            <div class="options-grid">${itemsHTML}</div>
                        </div>
                    `;
                });

                blockDiv.innerHTML = `
                    <div class="block-header" onclick="toggleBlock(this)">
                        <h3><span class="block-num">${block.id}</span> ${block.name}</h3>
                        <i class="fa-solid fa-chevron-down" style="color: var(--mint);"></i>
                    </div>
                    <div class="block-content">
                        <p style="color: #aaa; margin-top: 15px;">${block.desc}</p>
                        ${groupsHTML}
                    </div>
                `;
                container.appendChild(blockDiv);
            });
        }

        function toggleBlock(header) {
            const content = header.nextElementSibling;
            const icon = header.querySelector('i');

            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.style.transform = 'rotate(0deg)';
            } else {
                content.classList.add('active');
                icon.style.transform = 'rotate(180deg)';
            }
        }

        function handleSelect(blockId, groupIndex, itemId, type) {
            // Find Group Data
            const block = presetData.find(b => b.id === blockId);
            const group = block.groups[groupIndex];

            if (type === 'static') {
                // Static items might always be selected or simple toggle?
                // Let's assume toggle for copy ease
                toggleItemState(itemId);
                return;
            }

            if (type === 'radio') {
                // Deselect siblings in group
                group.items.forEach(i => {
                    if (selectedItems.has(i.id) && i.id !== itemId) {
                        selectedItems.delete(i.id);
                        updateCardVisual(i.id, false);
                    }
                });
                // Select clicked (Radio usually forces selection, but let's allow toggle off too)
                if (!selectedItems.has(itemId)) {
                    selectedItems.add(itemId);
                    updateCardVisual(itemId, true);
                }
            }

            if (type === 'checkbox') {
                toggleItemState(itemId);
            }

            updateClipboard();
        }

        function toggleItemState(id) {
            if (selectedItems.has(id)) {
                selectedItems.delete(id);
                updateCardVisual(id, false);
            } else {
                selectedItems.add(id);
                updateCardVisual(id, true);
            }
        }

        function updateCardVisual(id, isSelected) {
            const card = document.getElementById(`card-${id}`);
            const check = document.getElementById(`check-${id}`);

            if (isSelected) {
                card.classList.add('selected');
                if (check.querySelector('i')) check.querySelector('i').style.opacity = 1;
                else check.innerHTML = '<div style="width: 10px; height: 10px; background: var(--bg-deep); border-radius: 50%;"></div>';
            } else {
                card.classList.remove('selected');
                if (check.querySelector('i')) check.querySelector('i').style.opacity = 0;
                else check.innerHTML = '';
            }
        }

        function updateClipboard() {
            const bar = document.getElementById('clipBar');
            const count = document.getElementById('count');
            count.innerText = selectedItems.size;

            if (selectedItems.size > 0) bar.classList.add('active');
            else bar.classList.remove('active');
        }

        function copyAll() {
            let text = "";
            selectedItems.forEach(id => {
                // Need to find content efficiently. For this scale, loop is fine.
                for (const b of presetData) {
                    for (const g of b.groups) {
                        const item = g.items.find(i => i.id === id);
                        if (item) {
                            text += `### ${item.name}\n${item.content}\n\n`;
                            break;
                        }
                    }
                }
            });
            navigator.clipboard.writeText(text);
            const btn = document.querySelector('.clipboard-bar .btn-primary');
            btn.innerHTML = `<i class="fa-solid fa-check"></i> ( ‚ó°‚Äø‚ó° )`;
            setTimeout(() => btn.innerHTML = `<i class="fa-regular fa-copy"></i> –ö–û–ü–ò–†–û–í–ê–¢–¨`, 2000);
        }

        function clearAll() {
            selectedItems.forEach(id => updateCardVisual(id, false));
            selectedItems.clear();
            updateClipboard();
        }

        // --- LIGHTBOX ---
        function openLightbox(id, e) {
            e.stopPropagation();
            // Find item
            let item;
            for (const b of presetData) {
                for (const g of b.groups) {
                    item = g.items.find(i => i.id === id);
                    if (item) break;
                }
                if (item) break;
            }

            document.getElementById('modal-title').innerText = item.name;
            document.getElementById('modal-desc').innerText = item.desc;
            document.getElementById('modal-img').src = item.img || "https://files.catbox.moe/placeholder_generic.jpg"; // Use a default

            document.getElementById('modal').classList.add('active');
        }

        function closeModal(e, force) {
            if (force || e.target.id === 'modal') {
                document.getElementById('modal').classList.remove('active');
            }
        }

        // Initialize
        init();

    </script>
</body>
</html>
